#!/bin/bash

# target: /usr/local/bin 

# quick way to filter results when there's a lot of pods returned
action=$1
subaction=$2
query=$3
namespace=

if [[ "$@" == *"-n qa2"* ]]; then
  namespace='qa2'
elif [[ "$@" == *"-n qa"* ]]; then
  namespace='qa'
elif [[ "$@" == *"-n stg"* ]]; then
  namespace='stg'
elif [[ "$@" == *"-n prd"* ]]; then
  namespace='prd'
else
  namespace='dev'
fi

if ! [[ -z "$1" ]] && ! [[ -z "$2" ]]; then
    if [[ "$action" == 'get' ]]; then
        if [[ "$subaction" == 'pods' ]]; then
            echo Searching "'$namespace'" for "'*$query*'"
            echo
            kubectl get pods -n $namespace | awk '$1 ~ "'$query'" {print $0}'
            echo
            exit
        fi
    fi
fi

kubectl "$@"